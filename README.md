# Next.js 初始化模板

一个简洁的 Next.js 初始化模板，适合快速开始新项目或学习现代前端开发。

## ✨ 主要功能

### 数据持久化
- 使用 `zustand` + `localStorage` 实现本地数据持久化
- 所有任务的增删改操作都会自动保存到浏览器本地存储
- 刷新页面后数据不会丢失
- 提供数据管理功能，可以重置到初始状态

### 🔒 密码保护优先级功能 ⭐️ NEW
- **密码保护**: 优先级修改需要管理密码验证
- **独立操作**: 在任务操作栏添加专门的"优先级"按钮
- **四级优先级**: 紧急(红色)、优先(橙色)、正常(蓝色)、宽松(绿色)
- **安全防护**: 防止误操作和未授权修改，确保重要任务优先级管理安全

### 📥 增强的多格式数据导入功能 ⭐️ ENHANCED
- **多格式支持**: JSON、CSV、HTML三种格式全面支持
- **智能解析**: 自动识别文件格式并进行相应解析
- **两种导入模式**:
  - **合并导入**: 保留现有数据，只添加新任务
  - **替换导入**: 完全替换现有数据
- **HTML解析增强**: 
  - 支持标准HTML表格结构
  - 智能列名匹配，大小写不敏感
  - 支持中英文列名混合使用
  - 详细的解析日志和错误提示
  - 容错处理，跳过错误行继续解析

**HTML导入支持的列名格式**:
- 任务编号: `任务编号`, `ID`, `编号`, `任务ID`, `id`
- 尺寸: `尺寸`, `规格`, `大小`, `size`
- 颜色: `颜色`, `色彩`, `color`
- 状态: `状态`, `进度`, `status`, `阶段`
- 优先级: `优先级`, `重要性`, `priority`, `等级`

### 🔄 多设备数据同步优化
- **智能合并算法**: 基于任务更新时间的智能合并
- **数据保护**: 确保所有设备的数据都不会丢失
- **冲突解决**: 自动选择最新版本的任务数据
- **合并提示**: 显示数据合并结果和统计信息

### 图片管理功能 📸
- **智能压缩**: 自动压缩上传的图片到合适大小（目标300KB）
- **多级压缩策略**: 根据原图大小自动调整压缩参数
- **存储空间监控**: 实时显示本地存储使用情况
- **上传限制**: 
  - 原文件最大5MB
  - 压缩后最大500KB
  - 自动检查存储空间
- **错误处理**: 友好的错误提示和恢复建议

### 存储空间管理 💾
- **实时监控**: 显示localStorage使用率
- **空间清理**: 一键清理其他应用的本地数据
- **预警机制**: 当存储空间使用率超过70%时提醒
- **智能提示**: 提供存储优化建议

### 打样任务管理
- 创建、编辑、删除打样任务
- 任务状态跟踪（准备中、对接中、备料中、打样中、后道处理、已完成、返工）
- 优先级管理（紧急、重要、正常、宽松）
- 多种筛选和搜索功能
- 数据导出功能

## 🚀 快速开始

### 安装依赖
```bash
npm i
```

> 强烈推荐安装 `Biome` 插件，提早规避 Bug
> 可在 cursor 左上角的插件市场中搜索并安装

### 启动开发服务器
```bash
npm run dev
```

打开 [http://localhost:3000](http://localhost:3000) 查看结果。

## 📥 HTML导入功能使用指南 ⭐️

### 支持的HTML格式
HTML导入功能支持标准的HTML表格结构，要求如下：

#### 基本格式要求
1. **文件类型**: `.html` 或 `.htm` 文件
2. **表格结构**: 必须包含 `<table>` 标签
3. **标题行**: 第一行必须是表头（`<th>` 或 `<td>`）
4. **数据行**: 从第二行开始是数据内容

#### 示例HTML格式
```html
<!DOCTYPE html>
<html>
<head>
    <title>任务数据</title>
</head>
<body>
    <table border="1">
        <tr>
            <th>任务编号</th>
            <th>尺寸</th>
            <th>颜色</th>
            <th>状态</th>
            <th>优先级</th>
        </tr>
        <tr>
            <td>TEST001</td>
            <td>39-42</td>
            <td>红色</td>
            <td>打样中</td>
            <td>紧急</td>
        </tr>
        <tr>
            <td>TEST002</td>
            <td>35-38</td>
            <td>蓝色</td>
            <td>备料中</td>
            <td>正常</td>
        </tr>
    </table>
</body>
</html>
```

#### 智能列名识别
系统支持多种列名格式，不区分大小写：
- **任务编号**: `任务编号`, `ID`, `编号`, `任务ID`, `id`
- **尺寸**: `尺寸`, `规格`, `大小`, `size`
- **颜色**: `颜色`, `色彩`, `color`
- **状态**: `状态`, `进度`, `status`, `阶段`
- **优先级**: `优先级`, `重要性`, `priority`, `等级`

#### 使用步骤
1. 点击 "导入数据" 按钮
2. 选择 "合并导入" 或 "替换导入" 模式
3. 点击 "网页报告 (.html)" 选项
4. 选择符合格式要求的HTML文件
5. 系统会自动解析并显示导入结果

#### 调试功能
- **控制台日志**: 打开浏览器开发者工具查看详细解析过程
- **错误提示**: 显示具体的解析错误和建议
- **进度反馈**: 实时显示解析的表格数量和行数
- **格式检查**: 自动检查表格结构和必要字段

### 测试文件
项目根目录包含 `test-import.html` 测试文件，可以直接用于测试HTML导入功能。

## 📸 图片上传使用指南

### 存储方式选择
- **NAS存储** (推荐): 无限容量，支持大文件，多设备同步
- **本地存储**: 快速便捷，但有5-10MB空间限制

### NAS存储配置 🚀

#### 支持的NAS类型
1. **WebDAV** (推荐): 群晖、威联通等主流NAS都支持
2. **HTTP上传**: 自定义上传API接口
3. **FTP over HTTP**: 传统FTP服务

#### 快速配置示例

**群晖 Synology NAS:**
```
类型: WebDAV
服务器: http://192.168.1.100:5005
用户名: your-username
密码: your-password
路径: /images
```

**威联通 QNAP NAS:**
```
类型: WebDAV
服务器: http://192.168.1.100:8080
用户名: your-username
密码: your-password
路径: /multimedia
```

**自建服务器 (Nginx):**
```
类型: HTTP
服务器: http://your-server.com
端点: /api/upload
用户名: api-user
密码: api-key
```

#### 配置步骤
1. 点击页面上的 "NAS存储配置" 按钮
2. 选择你的NAS类型（推荐WebDAV）
3. 填写服务器地址、用户名、密码
4. 设置存储路径（如 `/images`）
5. 点击 "测试连接" 验证配置
6. 保存配置并启用NAS存储

#### 常见问题解决
- **连接失败**: 检查IP地址、端口号、防火墙设置
- **认证失败**: 确认用户名密码正确，账号有写入权限
- **路径错误**: 确保目标文件夹存在，路径格式正确
- **端口问题**: 群晖默认5005(HTTP)/5006(HTTPS)，威联通默认8080

### 推荐的图片规格
- **文件格式**: JPG、PNG、WebP
- **文件大小**: 
  - NAS存储: 最大50MB
  - 本地存储: 最大5MB (会自动压缩)
- **推荐尺寸**: 
  - NAS存储: 可保持原始尺寸
  - 本地存储: 1200x800像素以下
- **注意事项**: NAS存储保持原始质量，本地存储会智能压缩

### 存储空间管理
1. **监控使用率**: 页面顶部显示实时存储使用率
2. **查看详情**: 点击存储指示器查看详细信息
3. **NAS优势**: 
   - 无空间限制
   - 原始质量保存
   - 多设备同步访问
   - 自动备份
4. **本地备选**: NAS失败时自动回退到本地存储

### 混合存储策略
系统采用智能混合存储：
1. **优先NAS**: 配置后优先使用NAS存储
2. **自动回退**: NAS失败时自动使用本地存储
3. **状态提示**: 清楚显示每张图片的存储方式
4. **无缝体验**: 用户无需关心技术细节

### 常见问题解决
- **上传失败**: 检查图片大小和格式
- **存储空间不足**: 删除旧图片或清理其他数据
- **图片质量**: 系统会在保持清晰度的前提下压缩文件

### 线上部署

#### 使用 Vercel 一键部署

Vercel 是 Next.js 官方推荐的零配置部署平台，非常适合静态和 SSR 应用。

**完整步骤如下：**

##### 第一步：准备 GitHub 仓库

1. **注册 GitHub 账号**
   - 前往 [https://github.com/](https://github.com/) 
   - 点击 "Sign up" 注册新账号
   - 填写用户名、邮箱、密码并验证

2. **创建新仓库**
   - 登录后点击右上角的 "+" 按钮
   - 选择 "New repository"
   - 仓库名称填写：`my-nextjs-app`（可自定义）
   - 设置为 Public（公开）
   - 点击 "Create repository"

3. **上传项目代码**
   ```bash
   # 在项目根目录执行
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/你的用户名/my-nextjs-app.git
   git push -u origin main
   ```

##### 第二步：部署到 Vercel

1. **注册登录 Vercel**
   - 前往 [https://vercel.com/](https://vercel.com/) 
   - 点击 "Sign up" 并选择 "Continue with GitHub"
   - 授权 Vercel 访问你的 GitHub 账号

2. **导入项目**
   - 登录后点击 "New Project"
   - 选择刚才创建的 GitHub 仓库
   - 点击 "Import"

3. **配置部署**
   - Framework Preset：自动检测为 "Next.js"
   - Build Command：`npm run build`（通常自动填写）
   - Output Directory：`.next`（通常自动填写）
   - Install Command：`npm install`（通常自动填写）

4. **开始部署**
   - 点击 "Deploy" 按钮
   - 等待 2-3 分钟完成构建
   - 部署成功后会得到一个免费的 `.vercel.app` 域名

##### 第三步：后续更新

以后每次修改代码并推送到 GitHub，Vercel 会自动重新部署：

```bash
git add .
git commit -m "更新说明"
git push
```

#### 其他部署选项

##### Netlify（备选方案）
1. 前往 [https://netlify.com/](https://netlify.com/)
2. 注册并连接 GitHub
3. 选择仓库并部署
4. 构建命令：`npm run build`
5. 发布目录：`out`

##### 本地构建测试
```bash
npm run build      # 构建生产版本
npm start         # 启动生产服务器
```

**🎉 恭喜！** 你的 Next.js 应用现在已经上线了！

## 🔧 技术特性

### 性能优化
- 图片智能压缩算法
- 多级压缩策略
- 存储空间预检查
- 异步数据同步

### 用户体验
- 实时存储监控
- 友好错误提示
- 渐进式压缩
- 上传进度反馈

### 数据安全
- 本地优先存储
- 可选云端同步
- 数据备份与恢复
- 错误恢复机制

## 📄 许可证

MIT License - 可自由使用和修改。

---

**开始你的 Next.js 之旅吧！** 🎉
